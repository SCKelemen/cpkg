# cpkg v2.1.0 Release Notes

## Overview

cpkg v2.1.0 is a minor release that adds a global `--format` flag for JSON and YAML output, making it easier to integrate cpkg with other tools like `jq` and `yq`. This release also includes comprehensive command documentation and improved release notes automation.

## Installation

### From Source (Recommended)

```bash
go install github.com/SCKelemen/cpkg@v2.1.0
```

### Pre-built Binaries

Download pre-built binaries for your platform from the [Releases](https://github.com/SCKelemen/cpkg/releases) page:

- **Linux (amd64)**: `cpkg-linux-amd64`
- **macOS (Apple Silicon)**: `cpkg-darwin-arm64`

After downloading, make the binary executable and move it to your PATH:

```bash
# Linux
chmod +x cpkg-linux-amd64
sudo mv cpkg-linux-amd64 /usr/local/bin/cpkg

# macOS
chmod +x cpkg-darwin-arm64
sudo mv cpkg-darwin-arm64 /usr/local/bin/cpkg
```

## What's New

### Major Features

#### Global `--format` Flag for JSON/YAML Output

**New:** Added a global `--format` flag that allows you to switch the output format of commands that produce structured data. This makes it easy to work with cpkg output in other tools like `jq`, `yq`, or custom scripts.

**Supported formats:**
- `text` - Human-readable text output (default)
- `json` - JSON output for machine parsing
- `yaml` - YAML output for machine parsing

**Supported commands:**
- `cpkg list --format json`
- `cpkg check --format json`
- `cpkg status --format yaml`
- `cpkg explain <module> --format json`
- `cpkg graph --format json`

**Examples:**

```bash
# Get JSON output for parsing with jq
cpkg list --format json | jq '.dependencies[] | select(.status == "locked")'

# Get YAML output
cpkg check --format yaml > check-results.yaml

# Use in scripts
for module in $(cpkg list --format json | jq -r '.dependencies[].module'); do
  echo "Checking $module"
  cpkg explain "$module" --format json
done
```

### Improvements

#### Comprehensive Command Documentation

- Added `docs/commands.md` with complete documentation for all cpkg commands
- Each command includes:
  - Help text output
  - Description and usage
  - All flags and arguments documented
  - Examples and notes
  - Format support information (where applicable)

#### Release Notes Automation

- Improved release notes workflow with better debugging output
- Enhanced error handling for release notes file lookup
- More verbose logging to help diagnose release notes issues

### Testing

- Added comprehensive tests for the format package
- Added tests for command output formatting (JSON/YAML)
- All format-related functionality is now fully tested

## Migration Guide

### From v2.0.0 to v2.1.0

No breaking changes. This is a minor release with new features.

**No action required** - you can upgrade directly:

```bash
go install github.com/SCKelemen/cpkg@v2.1.0
```

Or if using pre-built binaries, download the new version from the [Releases](https://github.com/SCKelemen/cpkg/releases) page.

**New features available:**
- Use `--format json` or `--format yaml` with supported commands for machine-readable output
- See `docs/commands.md` for complete command documentation

## Commands

All commands from v2.0.0 are still available:

- `cpkg init` - Initialize a new module
- `cpkg add` - Add dependencies
- `cpkg tidy` - Resolve and lock dependencies
- `cpkg sync` - Sync git submodules
- `cpkg vendor` - Create vendor directory (symlink or copy)
- `cpkg upgrade` - Upgrade dependencies within constraints
- `cpkg check` - Check for available updates
- `cpkg list` - List all dependencies (supports `--format`)
- `cpkg explain` - Show detailed dependency information (supports `--format`)
- `cpkg status` - Check dependency status (supports `--format`)
- `cpkg build` - Run build commands
- `cpkg test` - Run test commands
- `cpkg graph` - Display the dependency graph (supports `--format`)
- `cpkg version` - Show detailed version information
- `cpkg help` - Show command help

## Requirements

- Go 1.21 or later
- Git (for submodule management)
- A C build system (Make, CMake, Ninja, etc.)

## Full Changelog

For a complete list of changes, see the [GitHub compare view](https://github.com/SCKelemen/cpkg/compare/v2.0.0...v2.1.0).

